<!DOCTYPE HTML>
<html>
<meta charset="utf-8">

<head>
    <title>七月牌位列印</title>
    <style id="mula">
        /*#div2 {
            無作用
            width: 275mm;
        }*/

        ::selection {
            background: darkred;
            color: yellow;
        }

        #div1>div {
            display: inline-block;
            border: 0.5px solid gray;
            /*配合A4紙大小
            滿版列印*/
            width: 58mm;
            height: 190mm;
            /*有邊界列印，或者可在列印時縮小比例
            width: 54mm;
            height: 185mm;*/
            /*轉直排語法*/
            -webkit-writing-mode: vertical-rl;
            writing-mode: vertical-rl;
        }

        .wun {
            /*背景圖片*/
            background-image: url(pic/wun-1.png);
            /*滿版列印*/
            background-size: 100% 100%;
            /*有邊界列印
            background-size: 98% 100%;*/
        }

        .wun2 {
            /*背景圖片*/
            background-image: url(pic/wun2-1.png);
            /*滿版列印*/
            background-size: 100% 100%;
            /*有邊界列印
            background-size: 98% 100%;*/
        }

        .live {
            /*背景圖片*/
            background-image: url(pic/live.png);
            /*滿版列印*/
            background-size: 100% 100%;
            /*有邊界列印
            background-size: 98% 100%;*/
        }

        .dead {
            /*背景圖片*/
            background-image: url(pic/dead.png);
            background-size: 101% 100%;
            /*有邊界列印
            background-size: 98% 100%;*/
        }

        .address {
            margin: 57mm 3mm 0 0;
            width: 10mm;
            /*不設定高度，長地址可一直呈現
            height: ;*/
            /*border: 1px solid #aaa;*/
            font-size: 16pt;
        }

        .name1 {
            margin: 70mm 2mm 0 0;
            width: 30mm;
            height: 55mm;
            /*border: 1px solid #aaa;*/
            font-size: 24pt;
            text-align: center;
            /*多餘的不顯示*/
            overflow: hidden;
        }

        .name2 {
            margin: 72mm 1mm 0 0;
            width: 30mm;
            height: 60mm;
            /*border: 1px solid #aaa;*/
            font-size: 24pt;
            text-align: center;
            /*多餘的不顯示*/
            overflow: hidden;
        }

        .name3 {
            /*海濤法師慈悲僧伽會牌位☑與□*/
            margin: 92mm -34mm 0 0;
            padding: 0 2mm 0 0;
            width: 36mm;
            height: 55mm;
            /*border: 1px solid #aaa;*/
            font-size: 12pt;
            background: white;
        }

        .sit1 {
            /*往生蓮位*/
            float: right;
            margin: -120mm -19mm 0 0;
            width: 10mm;
            height: 56mm;
            /*border: 1px solid #aaa;*/
            font-size: 22pt;
            font-family: 標楷體;
            text-align: left;
        }

        span {
            background: white;
        }

        .sit2 {
            /*會亂跑 昭穆宗親
            position: absolute;*/
            float: right;
            font-size: 18pt;
            font-family: 標楷體;
            line-height: 20pt;
            text-align: center;
            /*border: 1px solid #aaa;*/
        }

        .son {
            margin: 102mm 4mm 0 0;
            width: 8mm;
            height: 88mm;
            font-size: 18pt;
            /*border: 1px solid #aaa;*/
            /*text-align: center;*/
            /*多餘的不顯示*/
            overflow: hidden;
        }

        #txt1 {
            width: 80vw;
            height: 20vh;
        }

        input {
            height: 35px;
            background: yellowgreen;
            color: black;
            border-radius: 15px;
        }

        #btn1,
        #btn5,
        #btnR {
            background: hotpink;
        }

        #btn2,
        #btnY {
            background: yellow;
        }

        #btn3,
        #btn6,
        #btnht,
        b {
            background: orange;
        }

        #btnW,
        #btnwun {
            background: snow;
        }

        .HK,
        #btnP {
            background: lightblue;
        }

        #btnwun2,
        #btnpink {
            background: pink;
        }

        /** {
            border-radius: 3px;
        }*/

        #btnHidden {
            height: 8px;
            width: 8px;
            background: white;
        }

        #btnHidden:hover {
            height: 35px;
            width: 5cm;
            background: white;
        }

        input:hover,
        textarea:hover {
            border: 2px solid fuchsia;
            box-shadow: 5px 5px 20px darkorchid
        }

        input:active,
        textarea:active {
            border-color: indigo #f3f #f6f indigo;
            border-width: 5px;
            border-style: solid;
            box-shadow: 5px -5px 20px darkorchid
        }

        /*table{border: 3px solid darkgoldenrod;}*/

        td {
            border: 1px solid black;
        }

        tr:hover {
            border: 1px solid fuchsia;
            box-shadow: 5px 5px 20px darkorchid;
            background: cyan;
        }

        /*tr:nth-of-type(odd){ background: lightgreen; }
tr:nth-of-type(even){ background: lightblue; }
tr:hover{background: wheat;}*/
    </style>
    <style id="change"></style>
    <style id="changeColor"></style>
    <script>
        var Arr1 = []
        var Arr2 = []
        var Arr3 = []
        var Arr4 = []

        var ZZ, YY, XX, AA, BB, CC, DD

        function zzUp() {
            // 回覆上一步的值
            ZZ = txt1.value
            // 預先導入陣列
            Arr1 = txt1.value.split('\n')
        }
        function Copy() {
            // 結束時選取並複製文本框中的內容
            txt1.select()
            document.execCommand('Copy')
        }
        function overCopy() {
            // 結束時呈現結果
            txt1.value = Arr1.join('\n')
            // 結束時選取並複製文本框中的內容
            txt1.select()
            document.execCommand('Copy')
        }
        function delTab(a) {
            var oObj = document.getElementById(a)
            while (oObj.firstChild) {
                oObj.removeChild(oObj.firstChild)
            }
        }

        // 設定多個參數，就可以共用一個函數
        function addLiveDead(pic, name, nameHeight, text, showSit, showSon) {
            // 先導入陣列
            zzUp()
            // 先刪除舊表格
            delTab('div1')
            for (var i = 0; i < Arr1.length; i++) {
                // 刪除行首空白
                Arr1[i] = Arr1[i].replace(/^\s+/, '')
                // 各項資料，導入二維陣列
                Arr2[i] = []
                Arr2[i] = Arr1[i].split('\t')

                // 先處理：使用者亂寫的標點符號。轉換成空白。但地址有時會用到-()所以不能排除
                Arr2[i][0] = Arr2[i][0].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                // 2020為了廣嚴淨苑使用：無地址的，都先訂為「香港」，後來2021改為「吉祥地」
                if (!Arr2[i][1]) {
                    // Arr2[i][1] = '香港'
                    Arr2[i][1] = '　吉祥地'
                }
                // 祿位無陽上人，會出錯，所以必須判斷
                if (Arr2[i][2]) {
                    Arr2[i][2] = Arr2[i][2].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                }

                // 建立要填入的人名、地址…div，背景牌位用css
                var aDiv = document.createElement('div')
                aDiv.setAttribute('class', pic)

                // 地址
                var c = document.createElement('div')
                c.setAttribute('class', 'address')
                c.innerHTML = Arr2[i][1]
                aDiv.appendChild(c)

                // 人名、亡者
                var b = document.createElement('div')
                b.setAttribute('class', name)
                // 設定高度，為調整祖先牌位與祿位的差異。最多可寫入3個字的姓氏，4字以上就會跑位
                b.style.height = nameHeight
                // text 為加入「昭穆宗親」
                b.innerHTML = Arr2[i][0] + text
                aDiv.appendChild(b)

                // 往生蓮位
                var e = document.createElement('div')
                // 設定可不呈現
                e.style.display = showSit
                e.setAttribute('class', 'sit1')
                e.innerHTML = '<span>往生蓮位</span>'
                aDiv.appendChild(e)

                // 陽上人
                var d = document.createElement('div')
                // 設定可不呈現
                d.style.display = showSon
                d.setAttribute('class', 'son')
                d.innerHTML = Arr2[i][2]
                aDiv.appendChild(d)

                div1.appendChild(aDiv)

                // 用css語法來調整字距，先歸零
                change.innerHTML = ''
            }

            // 把undefined轉為空白，這樣牌位就不會浪費，變為空白牌位，還可以手寫
            div1.innerHTML = div1.innerHTML.replace(/undefined/g, ' ')
        }

        // 轉換紅金白色蓮座
        function SitColor(a, b) {
            changeColor.innerHTML = '.live{background-image: url(pic/live' + a + '.png);}.dead{background-image: url(pic/dead' + b + '.png);}'
        }

        // 海濤法師慈悲僧伽會牌位
        function HtDead() {
            // 先導入陣列
            zzUp()
            // 先刪除舊表格
            delTab('div1')
            for (var i = 0; i < Arr1.length; i++) {
                // 刪除行首空白
                Arr1[i] = Arr1[i].replace(/^ +/, '')
                // 各項資料，導入二維陣列
                Arr2[i] = []
                Arr2[i] = Arr1[i].split('\t')

                // 先處理：使用者亂寫的標點符號。轉換成空白。但地址有時會用到-()所以不能排除。
                Arr2[i][0] = Arr2[i][0].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                // 祿位無陽上人，會出錯，所以必須判斷
                if (Arr2[i][2]) {
                    Arr2[i][2] = Arr2[i][2].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                }

                // 建立要填入的人名、地址…div，背景牌位用css
                var aDiv = document.createElement('div')
                aDiv.setAttribute('class', 'dead')

                // 地址
                var c = document.createElement('div')
                c.setAttribute('class', 'address')
                c.innerHTML = Arr2[i][1]
                aDiv.appendChild(c)

                // 人名、亡者
                var b = document.createElement('div')
                b.setAttribute('class', 'name2')
                b.innerHTML = Arr2[i][0]
                aDiv.appendChild(b)

                // 加入9種類別
                var f = document.createElement('div')
                f.setAttribute('class', 'name3')
                f.innerHTML = '<span class="no">☑</span>歷代祖先　<span class="no">☑</span>歷代祖先的累劫冤親債主及墮胎嬰靈<br/><span class="no">☑</span>七世父母　<span class="no">☑</span>七世父母的累劫冤親債主及墮胎嬰靈<br/><span class="no">☑</span>累劫冤親債主<br/><span class="no">☑</span>墮胎嬰靈　<span class="no">☑</span>地基主</span>'
                // 自訂類別，前面補□號，google表單是用,號分隔
                // <input type="checkbox" checked="true"/>□ ☒ ☑
                //     f.innerHTML = '□' + Arr2[i][0].replace(/\,/g, '<br/>□')
                aDiv.appendChild(f)

                // 用css語法來調整字距
                change.innerHTML = '#div1>div {font-family: 標楷體;}.address{width: 8mm;} .name2 {margin: 72mm 14mm 0 0;width: 20mm;height: 18mm;font-size: 16pt; overflow: hidden;}.son {margin: 102mm 0 0 0;}.sit1 {margin: -108mm -27mm 0 0; width: 18mm;  font-size: 22pt;}'

                // 往生蓮位
                var e = document.createElement('div')
                e.setAttribute('class', 'sit1')
                // 空間不夠，所以折行
                e.innerHTML = '<span>往生<br/>蓮位</span>'
                e.style.height = '42mm'
                aDiv.appendChild(e)

                // 陽上人
                var d = document.createElement('div')
                d.setAttribute('class', 'son')
                d.innerHTML = Arr2[i][2]
                aDiv.appendChild(d)

                div1.appendChild(aDiv)
            }

            // 把undefined轉為空白，這樣牌位就不會浪費，變為空白牌位，還可以手寫
            div1.innerHTML = div1.innerHTML.replace(/undefined/g, ' ')

            // ☑與□的切換
            var VV = document.getElementsByClassName('no')
            for (var k of VV) {
                k.onmousedown = function () {
                    if (this.innerHTML == '☑') {
                        this.innerHTML = '□'
                    } else {
                        this.innerHTML = '☑'
                    }
                }
            }
        }

        // 人名資料：預先處理雜亂的資料。因為信徒常常亂填資料，資料的差異性太大！
        function cleanData(nn1, nn2, nn3) {
            // 導入陣列
            zzUp()
            // 準備空物件
            AA = ''
            BB = ''
            CC = ''
            DD = ''
            for (var i = 0; i < Arr1.length; i++) {
                // 刪除行首空白，及人名後的空白。刪除上次的===號
                Arr1[i] = Arr1[i].replace(/^\s+/, '').replace(/ \t/g, '\t').replace(/^\=+\d+\=+/, '')
                // 各項資料，導入二維陣列
                Arr2[i] = []
                Arr2[i] = Arr1[i].split('\t')

                // 先處理：使用者亂寫的標點符號。轉換成空白。但地址有時會用到-()所以不能排除
                Arr2[i][0] = Arr2[i][0].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                if (Arr2[i][2]) {
                    Arr2[i][2] = Arr2[i][2].replace(/[\,\.\/\\\;\:\'\"\[\]\(\)\{\}_\-\=\+\*\|\<\>\&\%\~\!˙　丶，。、．‧！；‥：「」…＆]/g, ' ').replace(/ +/g, ' ').replace(/^ +/g, '').replace(/ +$/g, '')
                }
                // 轉換後的資料，導入新陣列
                Arr4[i] = Arr2[i].join('\t')

                // 有人矚名「佛弟子」「無」…，亂寫資料，故排除他
                // 祖先資料比較無人亂寫資料，故不必判斷排除
                // if (Arr2[i][2] != '佛弟子' && Arr2[i][2] != '無' && Arr2[i][2] != '無名氏' && Arr2[i][2] != '三宝弟子' && Arr2[i][2] != '三寶弟子') {
                // 判斷人名，超過18，要調整
                // 判斷祖先人名，超過字數3
                if (Arr2[i][0].length > nn1) {
                    AA += Arr4[i] + '※☆☆※'
                    // 判斷人名，可用寬行距列印
                    // 判斷祖先人名，三字姓
                } else if (Arr2[i][0].length > nn2) {
                    BB += Arr4[i] + '※☆☆※'
                    // 判斷人名，可用窄行距列印
                    // 判斷祖先人名，複姓
                } else if (Arr2[i][0].length > nn3) {
                    CC += Arr4[i] + '※☆☆※'
                } else {
                    // 正常12個字
                    // 祖先正常1個字
                    DD += Arr4[i] + '※☆☆※'
                }
                // }
            }
            // 導入文本框，但還要手動修訂！因為信徒常常亂填資料。刪除最末尾的空行
            txt1.value = AA + '\n===' + nn1 + '===\n' + BB + '\n===' + nn2 + '===\n' + CC + '\n===' + nn3 + '===\n' + DD
            txt1.value = txt1.value.replace(/※☆☆※/g, '\n').replace(/\n+/g, '\n').replace(/(.+)\n$/, '$1')

            // 用新的ES6語法Set，可自動刪除重複的資料，但要用from從物件轉為陣列
            Arr1 = Array.from(new Set(txt1.value.split('\n')))

            // 自動複製
            overCopy()
        }

        window.onload = function () {

            // 廣嚴淨苑香港信徒資料轉換往生牌位
            btn7.onclick = function () {
                // 導入陣列
                zzUp()
                for (var i = 0; i < Arr1.length; i++) {
                    // 各項資料，導入二維陣列
                    Arr2[i] = []
                    Arr2[i] = Arr1[i].split('\t')
                    // 刪除行首空白，及人名後的空白
                    // 轉換香港資料
                    // Arr1[i] = Arr1[i].replace(/^\s+/, '').replace(/ \t/g, '\t').replace(/^(.)(.+)/, '$1氏歷代祖先先遠昭穆宗親及九玄七祖\t香港\t$1$2\n過去世之冤親債主\t香港\t$1$2\n七世父母\t香港\t$1$2')

                    // 判斷有無地址
                    if (Arr2[i][1]) {
                        XX = Arr2[i][1]
                    } else {
                        XX = '香港'
                    }
                    // 直接導入Arr1
                    Arr1[i] = Arr2[i][0].replace(/^\s+/, '').replace(/ \t/g, '\t').replace(/^(.)(.+)/, '$1氏歷代祖先先遠昭穆宗親\t' + XX + '\t$1$2\n過去世之冤親債主\t' + XX + '\t$1$2\n七世父母\t' + XX + '\t$1$2')
                    Arr3[i] = Arr2[i][0].replace(/^\s+/, '').replace(/ \t/g, '\t').replace(/^(.)(.+)/, '$1$2\t' + XX)
                }
                overCopy()
            }
            // 廣嚴淨苑香港信徒資料轉換消災牌位
            btn8.onclick = function () {
                // 先按前一個
                Arr1 = Arr3
                overCopy()
            }
            // 地址：香港轉台灣
            btn9.onclick = function () {
                txt1.value = txt1.value.replace(/香港/g, '台灣')
                Copy()
            }
            // 地址：undefined轉香港。因為來源資料空白的，都表示來自香港
            // btn10.onclick = function () {
            //     div1.innerHTML = div1.innerHTML.replace(/undefined/g, '香港')
            // }

            // 悟光精舍版牌位，一張A4中有10個牌位
            btnwun.onclick = function () {
                addLiveDead('wun', 'name2', '', '', 'none', 'block')
                change.innerHTML = '#div1>div {width: 36mm;height: 135mm;font-family: 標楷體;border:0;}.address{margin: 38mm 1mm 0 0;font-size: 12pt;width: 6mm;}.name2 {font-size: 18pt;width: 16mm;height: 65mm;margin: 28mm 3mm 0 0;}.son {font-size: 12pt;width: 5mm;height: 50mm;margin: 86mm 3mm 0 0;}'
            }

            // 悟光精舍版祿位，一張A4中有10個牌位
            btnwun2.onclick = function () {
                addLiveDead('wun2', 'name2', '', '', 'none', 'none')
                change.innerHTML = '#div1>div {width: 36mm;height: 135mm;font-family: 標楷體;border:0;}.address{margin: 38mm 1mm 0 0;font-size: 12pt;width: 6mm;}.name2 {font-size: 18pt;width: 16mm;height: 65mm;margin: 28mm 3mm 0 0;}.son {font-size: 12pt;width: 5mm;height: 50mm;margin: 86mm 1mm 0 0;}'
            }

            // 祿位名字，不可超過6人(18個字，多餘的不顯示)[舊版4人(12個字)]
            btn1.onclick = function () {
                addLiveDead('live', 'name1', '55mm', '', 'none', 'none')
            }

            // 亡者，不可超過6人(18個字，多餘的不顯示)[舊版4人(12個字)]
            // onkeyup輸入完，立刻呈現，後來發現不好用，還是手動呈現好
            btn2.onclick = function () {
                addLiveDead('dead', 'name2', '55mm', '', 'block', 'block')
            }

            // 祖先姓氏，不可超過4個字[舊版3個字]
            btn3.onclick = function () {
                addLiveDead('dead', 'name2', '60mm', '<div class="sit2">氏歷代祖先<br/>昭穆宗親', 'block', 'block')
                // 字體改小一點，可寫4字。用css語法來調整字距，另外加一個<style>標籤
                change.innerHTML = '.name2{margin:72mm 10mm 0 0;font-size:20pt;}.sit1{margin:-120mm -28mm 0 0;}.son{margin:102mm -5mm 0 0;}'
            }

            // 舊字距，適合少量名字
            btn4.onclick = function () {
                // 用css語法來調整字距，另外加一個<style>標籤
                change.innerHTML = '.name1 {margin: 70mm 9mm 0 0;}.name2 {margin: 72mm 11mm 0 0;}.sit1 {margin: -120mm -29mm 0 0;}.son {margin: 102mm -6mm 0 0;}'
            }

            btnP.onclick = function () {
                SitColor('-other', '4')
                changeColor.innerHTML += '.live{background-size: 107% 95%;}.dead{background-size: 97% 99%;}.name1{transform: scale(0.7,0.7);}'
            }

            // 隱藏下方所有按鈕
            btnHidden.onclick = function () {
                if (div2.style.display == 'block') {
                    div2.style.display = 'none'
                } else {
                    div2.style.display = 'block'
                }
            }

            // 為配合網路牌位，加上紅色底色，只有祿位，牌位無
            // 本來想用CSS語法，改變圖片顏色，但太複雜太難控制，還是改用「去背」的圖片
            btnpink.onclick = function () {
                // 先刪除舊的CSS語法，不然會亂掉
                if (changeColor.innerHTML) {
                    if (body1.style.background == 'pink' && /pic-bg/.test(changeColor.innerHTML)) {
                        body1.style.background = ''
                        changeColor.innerHTML = ''
                    } else {
                        body1.style.background = 'pink'
                        // 可以直接用正規表達式改CSS語法，改圖片路徑，變成新的去背的圖片
                        changeColor.innerHTML = changeColor.innerHTML.replace('(pic/', '(pic/pic-bg/')
                    }
                } else {
                    // 設定可以雙向改回原來的圖片
                    if (body1.style.background == 'pink' && /pic-bg/.test(mula.innerHTML)) {
                        body1.style.background = ''
                        mula.innerHTML = mula.innerHTML.replace('(pic/pic-bg/wun2-1.png', '(pic/wun2-1.png')
                        mula.innerHTML = mula.innerHTML.replace('(pic/pic-bg/live.png', '(pic/live.png')
                    } else {
                        body1.style.background = 'pink'
                        mula.innerHTML = mula.innerHTML.replace('(pic/wun2-1.png', '(pic/pic-bg/wun2-1.png')
                        mula.innerHTML = mula.innerHTML.replace('(pic/live.png', '(pic/pic-bg/live.png')
                        body1.style.background = 'pink'
                    }
                }

                // document.getElementsByTagName('style')[0].innerHTML.replace(/(background\-image\: url\(\a+\)\;)/g,'$1,linear-gradient(black ,red ,black );background-blend-mode:color-dodge;')
            }

            // 範例：
            var example1 = [
                '人名	地址',
                '張三三	台中市北屯區松竹路1段8號',
                '張三三 李四四	台中市北屯區松竹路1段8號',
                '張三三 李四四 王五五	台中市北屯區松竹路1段8號',
                '張三三 李四四 王五五 趙六六	台中市北屯區松竹路1段8號'
            ]
            var example2 = [
                '亡者	地址	陽上人',
                '張三三	台中市北屯區松竹路1段8號	何九九 石一二',
                '張三三 李四四	台中市北屯區松竹路1段8號	何九九',
                '張三三 李四四 王五五	台中市北屯區松竹路1段8號	何九九 石一二',
                '張三三 李四四 王五五 趙六六	台中市北屯區松竹路1段8號	何九九'
            ]
            var example3 = [
                '祖先姓氏	地址	陽上人',
                '陳	台中市北屯區松竹路1段8號	何九九 石一二',
                '歐陽	台中市北屯區松竹路1段8號	何九九',
                '威爾遜	台中市北屯區松竹路1段8號	何九九 石一二'
            ]

            // 範例圖表
            function addTable(ps, tab, background, Arr, nt) {
                // 二維陣列
                var Arr2 = []
                // 必須加入tbody，否則無法插入td
                tab.innerHTML = ps + '<tbody></tbody>'
                for (var i = 0; i < Arr.length; i++) {
                    Arr2[i] = Arr[i].split(nt)
                    var oTr = document.createElement('tr')
                    // 記得用[i]
                    for (var j of Arr2[i]) {
                        var oTd = document.createElement('td')
                        oTd.innerHTML = j
                        oTr.appendChild(oTd)
                    }
                    tab.tBodies[0].appendChild(oTr)
                    tab.style.background = background
                }
            }
            addTable('消災祿位範例：', tab1, 'hotpink', example1, '\t')
            addTable('往生牌位範例：', tab2, 'yellow', example2, '\t')
            addTable('祖先牌位範例：', tab3, 'orange', example3, '\t')
        }
    </script>
</head>

<body id="body1">
    <div id="div1"></div>
    <input type="button" id="btnHidden" value="隱藏多餘按鈕" />
    <div id="div2" style="display:block;">
        <input type="button" id="btn1" value="消災祿位" />
        <input type="button" id="btn2" value="往生牌位" />
        <input type="button" id="btn3" value="祖先牌位" />
        <input type="button" id="btn4" value="舊字距，適合少量名字" />
        <input type="button" id="btnR" value="紅色蓮座" onclick="SitColor('2','2')" />
        <input type="button" id="btnY" value="金色蓮座" onclick="SitColor('3','3')" />
        <input type="button" id="btnW" value="黑白蓮座" onclick="SitColor('','')" />
        <input type="button" id="btnP" value="敦煌華蓋" />
        <input type="button" id="btnpink" value="祿位轉紅底色，牌位無" />
        <hr />
        <input type="button" id="btn5" value="排序人名資料" onclick="cleanData(18,15,12)" />
        <input type="button" id="btn6" value="排序祖先資料" onclick="cleanData(3,2,1)" />
        <input type="button" id="btn7" class="HK" value="HK人名1轉3" />
        <input type="button" id="btn8" class="HK" value="HK人名轉消災" />
        <input type="button" id="btn9" class="HK" value="HK轉TW" />
        <!--<input type="button" id="btn10" class="HK" value="Undefined轉HK" />-->
        <hr />
        <input type="button" id="btnwun2" value="悟光精舍消災祿位" />
        <input type="button" id="btnwun" value="悟光精舍往生牌位" />
        <input type="button" id="btnht" value="慈悲僧伽會牌位" onclick="HtDead()" />
        <input id="reload" type="button" value="重整頁面" onclick="javascript:window.location.reload()" />
        <br />
        <textarea id="txt1" placeholder="在此輸入要迴向超渡的往生者姓名、要超渡的祖先姓氏、要消災的人名，
        輸入完畢後，鍵盤一停止，
        就會先呈現「往生牌位」！
    其它牌位：輸入完畢後，請按「消災祿位」「往生牌位」「祖先牌位」按鈕！
註：
    為節省紙張，同一地址的多人，可寫在同一張祿位上！
        祿位名字，不可超過6人(18個字，多餘的不顯示)[舊版4人(12個字)]，中間可用空白分隔。例：張三三 李四四 王五五 趙六六
        亡者，不可超過6人(18個字，多餘的不顯示)[舊版4人(12個字)]；陽上人不可超過4人(12個字，多餘的不顯示)，範例同上。
        祖先姓氏，不可超過4個字[舊版3個字]；陽上人不可超過4人(12個字，多餘的不顯示)
若一次要寫多人，而且準備日後重複使用資料，可用「試算表excel」寫資料，再用email寄來！ adb.dao@gmail.com
撰寫範例如下：
">張三三張三三-李四四-王五五張三三-李四四-王五五張三三-李四四-王五五	台中市北屯區松竹路1段8號-1	何九九[]
(張三三 )(李四四)	台中市北屯區松竹路1段8號*(7)	(何九九)() ;'何九九 []石一二 ][}{何九九 石一二 何九九 石一二
張三三-李四四-王五五張三三-李四四-王五五張三三-李四四-王五五張三三-李四四-王五五	台中市北屯區松竹路1段8號*(7)	何九九-石一二*何九九+石一二
 :張三三*李四四/王五五,. 趙六六.,	台中市北屯區松竹路1段8號/-*(7)	.何九九\;'' 石一二,
/>張三三 李四四;'' 王五五 趙六六 王五五 趙六六	台中市北屯區松竹路1段8號	何九九
張三三	台中市北屯區松竹路1段8號	何九九
張三三 李四四	台中市北屯區松竹路1段8號	何九九 何九九 石一二 何九九 石一二 何九九 石一二
張三三 李四四 王五五	台中市北屯區松竹路1段8號	何九九 石一二 何九九 石一二
張三三 李四四 王五五 趙六六	台中市北屯區松竹路1段8號	何九九 石一二
張三三 李四四 王五五 趙六六 王五五 趙六六	台中市北屯區松竹路1段8號	何九九
張三三	台中市北屯區松竹路1段8號	何九九
張三三 李四四	台中市北屯區松竹路1段8號	何九九 何九九 石一二 何九九 石一二 何九九 石一二
張三三 李四四 王五五	台中市北屯區松竹路1段8號	何九九 石一二 何九九 石一二
張三三 李四四 王五五 趙六六	台中市北屯區松竹路1段8號	何九九 石一二
張三三 李四四 王五五 趙六六 王五五 趙六六	台中市北屯區松竹路1段8號	何九九
張三三	台中市北屯區松竹路1段8號	何九九
張三三 李四四	台中市北屯區松竹路1段8號	何九九 何九九 石一二 何九九 石一二 何九九 石一二
張三三 李四四 王五五	台中市北屯區松竹路1段8號	何九九 石一二 何九九 石一二
張三三 李四四 王五五 趙六六	台中市北屯區松竹路1段8號	何九九 石一二
張三三 李四四 王五五 趙六六 趙六六張三三-李四四-王五五張三三-李四四-王五五	台中市北屯區松竹路1段8號	何九九</textarea>
        <br />
        <p>
        <h2>使用說明：</h2>
        <h3>文本框中，是輸入範例！請先刪除，再輸入新資料。</h3>
        <ol>
            <li>在此輸入要迴向超渡的往生者姓名、要超渡的祖先姓氏、要消災的人名，可寫多人！</li>
            <li>再用tab隔開。再寫地址。</li>
            <li>再用tab隔開。最後寫陽上人。</li>
            <li>撰寫範例見下表格：</li>
            <li>☆更快的方法：把整個excel表格複製到文本框中</li>
            <li>若一次要寫多人，而且準備日後重複使用資料，可用「試算表excel」寫資料</li>
        </ol>
        <ul>
            <li>其它牌位：輸入完畢後，請按「消災祿位」「往生牌位」「祖先牌位」按鈕！</li>
            <li>若資料量大，可先作「排序人名資料」，會刪除重複資料，並按18字、12字…排序</li>
            <li>HK是特別為香港信徒的資料轉換，從單一名字，轉出4種表格資料</li>
            <li>「消災祿位」按鈕上方，有一個小小的「隱藏多餘按鈕」的小按鈕，※滑鼠滑上去時才會顯現出來！，可先按鈕隱藏下方說明文字後，再列印。</li>
        </ul>

        <h3>海濤法師「慈悲僧伽會牌位」的輸入資料方法一樣。多加的功能：</h3>
        <ol>
            <li>點選☑與□可互相切換</li>
            <li>亡者名，最多9字，<b>多餘的不顯示</b></li>
            <li>可切換紅色金色蓮座(悟光精舍的不行)</li>
        </ol>

        <h3>※列印方法：</h3>
        <ol>
            <li>用chrome瀏覽器開啟，列印時，先按ctrl+P，</li>
            <li>點選「配置」→選「橫向」。</li>
            <li>再點選「顯示更多設定」，其中</li>
            <li>「邊界」→選「無」。或設定成你要的大小</li>
            <li>「選項」→「背景圖形」打鉤！</li>
            <li>再按「列印」即可！</li>
            <li>當然，紙張顏色…要先自備紅色、黃色…的紙！</li>
        </ol>
        </p>
        <!-- <h4>南普陀寺2020年農曆7月法會網路登記：
消災祿位
<a href="https://forms.gle/yFWJDybRpy21mPjSA" target="_blank">https://forms.gle/yFWJDybRpy21mPjSA</a>
往生牌位
<a href="https://forms.gle/7yS8pLqvGbiUhoBZ6" target="_blank">https://forms.gle/7yS8pLqvGbiUhoBZ6</a>
祖先牌位
<a href="https://forms.gle/ZDNvASvWinenP1jZ6" target="_blank">https://forms.gle/ZDNvASvWinenP1jZ6</a>
</h4>
        <h2>若一次要寫多人，而且準備日後重複使用資料，可用「試算表excel」寫資料，再用email寄來！
            <a href='mailto:adb.dao3@gmail.com'>adb.dao3@gmail.com</a></h2>
        <h3>截止日期：農曆7月12日晚上。國曆2020年8月30日 (※後來提早為農曆6月26就截止了！)</h3> -->
        <h3>撰寫範例如下：</h3>
        <hr />
        <table id="tab1">祿位名字，不可超過6人(18個字，<b>多餘的不顯示</b>)[舊版4人(12個字)]；為節省紙張，同一地址的多人，可寫在同一張祿位上！</table>
        <hr />
        <table id="tab2">亡者，不可超過6人(18個字，<b>多餘的不顯示</b>)[舊版4人(12個字)]；陽上人不可超過4人(12個字，<b>多餘的不顯示</b>)</table>
        <hr />
        <table id="tab3">祖先姓氏，不可超過4個字[舊版3個字]；陽上人不可超過4人(12個字，<b>多餘的不顯示</b>)</table>
    </div>
</body>

</html>